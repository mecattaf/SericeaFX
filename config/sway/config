# appearance

# Start flavours
set $base00 #151515
set $base01 #1f1f1f
set $base02 #282828
set $base03 #3b3b3b
set $base04 #e8e3e3
set $base05 #e8e3e3
set $base06 #e8e3e3
set $base07 #e8e3e3
set $base08 #b66467
set $base09 #d9bc8c
set $base0A #d9bc8c
set $base0B #8c977d
set $base0C #8aa6a2
set $base0D #8da3b9
set $base0E #a988b0
set $base0F #e8e3e3
# End flavours

# Property Name           Border  BG      Text    Indicator Child-border
client.focused            $base05 $base0D $base00 $base0D   $base0D
client.unfocused          $base01 $base00 $base05 $base01   $base01
client.focused_inactive   $base01 $base01 $base05 $base03   $base01
client.urgent             $base08 $base08 $base00 $base08   $base08
client.placeholder        $base00 $base00 $base05 $base00   $base00
client.background         $base07


# Mouse behavior
focus_follows_mouse no

# Font
font pango:JetBrainsMono Nerd Font 12


# Gaps
smart_gaps off
gaps inner 10

default_border pixel 5
default_floating_border normal
hide_edge_borders smart

# Gnome Settings
set $gnome-schema org.gnome.desktop.interface

exec_always {
        gsettings set $gnome-schema cursor-theme 'Bibata-Modern-Classic'
        gsettings set $gnome-schema gtk-theme 'Base16'
        #gsettings set $gnome-schema icon-theme 'Your icon theme'
        #gsettings set $gnome-schema font-name 'Your font name'
        gsettings set org.gnome.desktop.wm.preferences button-layout ""
}

# autostart

# Import variables into system-user environment
exec systemctl --user import-environment DISPLAY WAYLAND_DISPLAY SWAYSOCK

exec hash dbus-update-activation-environment 2>/dev/null && \
        dbus-update-activation-environment --systemd DISPLAY WAYLAND_DISPLAY SWAYSOCK

exec gammastep -t 3500:3500 -l 30.2:97.7 -m wayland
exec mako
#exec waybar
exec clipman restore
exec wl-paste -t text --watch clipman store
exec /var/home/dev/.local/share/bin/pomo start
exec /var/home/dev/.local/share/bin/pomo notify

#exec swaybg -c '#000000'
exec ~/.azotebg

#exec distrobox-enter music -- mpd

bar {
        swaybar_command waybar
        mode dock
        modifier Mod4
}


# bindings

# Variables

set $mod Mod4

set $term alacritty
set $host alacritty -o window.opacity=0.8

set $screenshot-full grim ~/Pictures/scrn-$(date +"%Y-%m-%d-%H:%M:%S").png && sleep .2 &&  notify-send " Screenshot" -t 250
set $screenshot-area slurp | grim -g - ~/Pictures/scrn-$(date +"%Y-%m-%d-%H:%M:%S").png && sleep .2 && notify-send " Screenshot" -t 250

set $WOBSOCK $XDG_RUNTIME_DIR/wob.sock
set $volume-up amixer sset Master 5%+ | sed -En 's/.*\[([0-9]+)%\].*/\1/p' | head -1 > $WOBSOCK && notify-send "ﱛ Volume up" -t 250
set $volume-down amixer sset Master 5%- | sed -En 's/.*\[([0-9]+)%\].*/\1/p' | head -1 > $WOBSOCK && notify-send "ﱜ Volume down" -t 250
set $volume-mute amixer sset Master toggle | sed -En '/\[on\]/ s/.*\[([0-9]+)%\].*/\1/ p; /\[off\]/ s/.*/0/p' | head -1 > $WOBSOCK

set $brightness-up light -A 5 && light -O && notify-send " Brightness up" -t 250
set $brightness-down light -U 5 && light -O && notify-send " Brightness down" -t 250
set $brightness-up-single light -A 1 && light -O && notify-send " Brightness up" -t 250
set $brightness-down-single light -U 1 && light -O && notify-send " Brightness down" -t 250



set $swappy grim -g "$(slurp)" - | swappy -f -

set $waybar-toggle pkill -SIGUSR1 '^waybar$'

#set $color-picker ###script-here && notify-send " Copied color"

set $scripts ~/.local/share/bin
set $fzf-wifi exec $term --class 'networkwidget' -t 'networkwidget' -e "$scripts/fzf-nmcli"
set $fzf-bluetooth exec $term --class 'bluetoothwidget' -t 'bluetoothwidget' -e '$scripts/fzf-bluetooth'
set $fzf-power-menu exec $term -o font.size=22 --class 'powerwidget' -t 'powerwidget' -e $scripts/fzf-power-menu
#set $fzf-dmenu

for_window [title="bluetoothwidget"] border pixel 0, floating enable, resize set 250 250, move position 1300 790
for_window [title="networkwidget"] border pixel 0, floating enable, resize set 453 500, move position 1380 490
for_window [title="powerwidget"] border pixel 0, floating enable, resize set 250 250, move position 0 0, focus


for_window [title="fzf-window-switcher"] border pixel 0, floating enable, resize set 250 250, move position 0 0, focus

for_window [title="clipboard-history"] focus

for_window [app_id="^launcher$"] floating enable, sticky enable, resize set 30 ppt 60 ppt, border pixel 10, focus

## Key bindings
#
# Basics:
#
    # Terminals
    bindsym $mod+Return exec flatpak run com.google.Chrome
    bindsym $mod+Shift+Return exec $host

    # Kill focused window
    bindsym $mod+Shift+q kill

    # Fzf application launcher
    bindsym $mod+d exec alacritty --class=launcher -e $scripts/sway-launcher-desktop


    # Reload configuration file
    bindsym $mod+Shift+r reload

    # Clipboard History
    bindsym $mod+v exec alacritty --class "clipboard-history" -t "clipboard-history" -e $scripts/fzf-clipboard-history

    # Emoji Menu
# fzf emoji instead
    #bindsym $mod+Shift+v exec $emoji

    # Screenshot Functionality
    bindsym $mod+s exec $screenshot-full
    bindsym $mod+Shift+s exec $screenshot-area
    bindsym Print  exec $swappy

    # Toggle waybar
    bindsym $mod+i exec $waybar-toggle
    bindsym $mod+Shift+i bar mode toggle

    # Toggle opacity
    bindsym $mod+o              opacity plus 0.1
    bindsym $mod+Shift+o        opacity minus 0.1

    # Launch file explorer
    bindsym $mod+e exec nautilus
    bindsym $mod+Shift+e exec alacritty -e ranger


    # Fzf-switcher
# https://github.com/ldelossa/sway-fzfify
        bindsym $mod+w exec     $scripts/fzf-workspace-switcher
        bindsym $mod+m exec     $scripts/fzf-marks-switcher
        bindsym $mod+c exec     $scripts/fzf-tree-switcher
        #bindsym $mod+o exec     $scripts/fzf-workspace-move
        bindsym $mod+r exec     $scripts/fzf-rename
        bindsym $mod+n exec     $scripts/fzf-new-workspace


    # Launch nvim session at the current directory
    #bindsym $mod+grave exec alacritty -e distrobox-enter neovim -- nvim
    #bindsym $mod+grave exec alacritty -e distrobox-enter neovim -- kitty -d $(readlink /proc/$(ps --no-headers --ppid $(swaymsg -t get_tree | jq '.. | select(.focused?==true) | .pid') | awk '{print $1}')/cwd || echo $HOME) -e nvim

    # Toggle focus between tiling area and floating area:
    bindsym $mod+Shift+Tab focus mode_toggle

    # Toggle focus between tiling mode and floating mode:
    bindsym $mod+Tab floating toggle

    # Volume Control
    bindsym XF86AudioRaiseVolume exec $volume-up
    bindsym XF86AudioLowerVolume exec $volume-down
    bindsym XF86AudioMute exec $volume-mute

    # Use the mic mute button to access settings
    bindsym XF86AudioMicMute      exec gnome-control-center
    bindsym $mod+XF86AudioMicMute      exec nm-connection-editor


    # Brightness Control
    bindsym XF86MonBrightnessUp   exec $brightness-up
    bindsym XF86MonBrightnessDown exec $brightness-down
    bindsym $mod+XF86MonBrightnessUp   exec $brightness-up-single
    bindsym $mod+XF86MonBrightnessDown exec $brightness-down-single


#Other special lenovo keys
#XF86Display #tbd
#XF86WLAN #Skip this one because it already turns airplane mode on and off
#XF86NotificationCenter #will be used for the Enoki Slack
#XF86PickupPhone #see later in config
#XF86HangupPhone #probably zoom?
#XF86Favorites #tbd
#Home
#End
#Insert
#Delete

    # VSCode
    #bindsym Mod1+Return exec distrobox-enter ubuntu-test -- code --enable-features=UseOzonePlatform --ozone-platform=wayland

    # Music
    #bindsym $mod+m exec $ncmpcpp
    #bindsym $mod+Shift+m exec $miniplayer

# Moving around:
#
    # Move focus around
    bindsym $mod+Shift+h exec swaymsg focus left
    bindsym $mod+Shift+j exec swaymsg focus down
    bindsym $mod+Shift+k exec swaymsg focus up
    bindsym $mod+Shift+l exec swaymsg focus right

    # Resize window
    bindsym $mod+Shift+Left resize shrink width 25
    bindsym $mod+Shift+Down resize shrink height 25
    bindsym $mod+Shift+Up resize grow height 25
    bindsym $mod+Shift+Right resize grow width 25

    # Move focused window
    bindsym $mod+h move left 20
    bindsym $mod+j move down 20
    bindsym $mod+k move up 20
    bindsym $mod+l move right 20
    # Same with arrow keys
    bindsym $mod+Left move left 50
    bindsym $mod+Down move down 50
    bindsym $mod+Up move up 50
    bindsym $mod+Right move right 50

    # Toggle window orientation
    bindsym $mod+BackSpace split toggle

    # Focus all tiled windows
    bindsym $mod+a focus parent

    # Alternate sticky
    bindsym $mod+Shift+a sticky toggle

    # Make the current focus fullscreen
    bindsym $mod+f fullscreen

    # Check on pomodoro status
    bindsym $mod+p exec $scripts/pomo notify
    bindsym $mod+Shift+p exec $scripts/pomo pause

    # Resizing to set sizes:
    bindsym $mod+Shift+f    resize set 900 600
    bindsym $mod+g          resize set 900 500
    bindsym $mod+Shift+g    resize set 500 500

    floating_modifier $mod normal

    # Power Menu
    bindsym Mod1+ctrl+Delete exec $fzf-power-menu

# input
seat seat0 xcursor_theme Bibata-Modern-Classic 24
seat seat1 xcursor_theme Bibata-Modern-Green 24
seat seat2 xcursor_theme Bibata-Modern-Red 24
seat seat3 xcursor_theme Bibata-Modern-Blue 24
seat seat4 xcursor_theme Bibata-Modern-Yellow 24
seat seat5 xcursor_theme Bibata-Modern-Orange 24
seat seat6 xcursor_theme Bibata-Modern-Purple 24

seat seat0 fallback true

#seat seat6 attach "1133:45849:Logitech_K810_Keyboard"
#input "0:0:TEX-BLE-KB-1_Keyboard" map_to_output "HDMI-A-1"

input "1267:12624:ELAN0670:00_04F3:3150_Touchpad" {
    tap enabled
    natural_scroll enable
    scroll_factor 0.5
    middle_emulation enabled
}

# window
# for_window [app_id=""] floating enable
for_window [app_id=".*"] floating enable, border pixel 4,  resize set height 100ppt width 100ppt, move window to workspace 1
for_window [class="Code"] floating enable, border pixel 2

for_window [app_id="Alacritty"] floating enable, border pixel 3,  resize set height 800 width 1200

no_focus [app_id=".*"]

# Workspace
    bindsym $mod+1 workspace number 1
    bindsym $mod+2 workspace number 2
    bindsym $mod+3 workspace number 3
    bindsym $mod+4 workspace number 4
    bindsym $mod+5 workspace number 5
    bindsym $mod+6 workspace number 6
    bindsym $mod+7 workspace number 7
    bindsym $mod+8 workspace number 8
    bindsym $mod+9 workspace number 9
    bindsym $mod+0 workspace number 10
    bindsym $mod+Shift+1 move container to workspace number 1
    bindsym $mod+Shift+2 move container to workspace number 2
    bindsym $mod+Shift+3 move container to workspace number 3
    bindsym $mod+Shift+4 move container to workspace number 4
    bindsym $mod+Shift+5 move container to workspace number 5
    bindsym $mod+Shift+6 move container to workspace number 6
    bindsym $mod+Shift+7 move container to workspace number 7
    bindsym $mod+Shift+8 move container to workspace number 8
    bindsym $mod+Shift+9 move container to workspace number 9
    bindsym $mod+Shift+0 move container to workspace number 10

# Kumospace
set $kumospace flatpak 'run' '--command=/app/bin/chrome' 'com.google.Chrome' '--profile-directory=Default' '--app-id=bhagmnmpoblnbmjhpmddmkkcikfbaggg'
bindsym XF86PickupPhone exec $kumospace
for_window [app_id="^chrome-bhagmnmpoblnbmjhpmddmkkcikfbaggg-Default"] mark "Kumospace", set opacity 0.9, sticky enable, resize set 30 ppt 60 ppt, border pixel 10, move position 0 0, focus


#XF86HangupPhone

# Chrome
# Fix for chrome applications on wayland, capturing focus
for_window [app_id="^chrome-.*"] shortcuts_inhibitor disable

set $google-chrome flatpak run com.google.Chrome
set $soundcloud flatpak 'run' '--command=/app/bin/chrome' 'com.google.Chrome' '--profile-directory=Default' '--app-id=eikjhbkpemdappjfcmdeeeamdpkgabmk'
set $notion flatpak 'run' '--command=/app/bin/chrome' 'com.google.Chrome' '--profile-directory=Default' '--app-id=mlneepkinfdepaiigomojgjbfpfieoln'
set $superhuman flatpak 'run' '--command=/app/bin/chrome' 'com.google.Chrome' '--profile-directory=Default' '--app-id=cabkgbgkeonbpeoedbaeolhgfkempoka'
set $trello flatpak 'run' '--command=/app/bin/chrome' 'com.google.Chrome' '--profile-directory=Default' '--app-id=kllgkemdchfblljcbacggbcjeongoidi'

# Autostart Chrome pages
#exec $google-chrome
#exec $soundcloud
#exec $notion
#exec $superhuman
#exec $trello

for_window [app_id="^google-chrome"] move container to workspace number 1
for_window [app_id="^chrome-eikjhbkpemdappjfcmdeeeamdpkgabmk-Default"] move container to workspace number 2
for_window [app_id="^chrome-mlneepkinfdepaiigomojgjbfpfieoln-Default"] mark "Notion", move scratchpad
for_window [app_id="^chrome-cabkgbgkeonbpeoedbaeolhgfkempoka-Default"] mark "Superhuman", move scratchpad
for_window [app_id="^chrome-kllgkemdchfblljcbacggbcjeongoidi-Default"] mark "Trello", move scratchpad
for_window [app_id="^chrome-bhagmnmpoblnbmjhpmddmkkcikfbaggg-Default"] mark "Kumospace", set opacity 0.9, move scratchpad


#for_window [app_id="^chrome--Default"] move container to workspace 14

# to start enoki browser
# flatpak 'run' '--command=/app/bin/chrome' 'com.google.Chrome' '--profile-directory=Profile 2' '--app-id=enoki'


# output
exec kanshi

# Touchpad gestures
bindgesture swipe:3:up move up 50
bindgesture swipe:3:left move left 50
bindgesture swipe:3:right move right 50
bindgesture swipe:3:down move down 50

bindgesture swipe:4:up resize grow height 25
bindgesture swipe:4:left resize shrink width 25
bindgesture swipe:4:right resize grow width 25
bindgesture swipe:4:down resize shrink height 25

# swayfx changes
#shadows enable
#corner_radius 12
#for_window [app_id="foot"] blur enable
#blur_radius 7
#blur_passes 4
#corner_radius 6
#shadows enable
#default_dim_inactive 0.05
#layer_effects "waybar" blur enable; shadows enable;
#scratchpad_minimize disable